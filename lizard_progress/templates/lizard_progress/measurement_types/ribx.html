{% with location=locations.0 %}
  {% if location.location_type == "pipe" %}
     <h3>Streng {{ location.location_code }}</h3>
  {% elif location.location_type == "manhole" %}
     <h3>Put {{ location.location_code }}</h3>
  {% elif location.location_type == "drain" %}
     <h3>Kolk {{ location.location_code }}</h3>
  {% else %}
     <h3>Onbekend rioleringselement {{ location.location_code }}</h3>
  {% endif %}
  {% if location.complete %}
     <h3>Compleet</h3>
  {% endif %}
  {% if location.not_part_of_project %}
    <strong>Dit object is geen eigendom van {{
    location.activity.project.organization }} en hoort niet bj de
    werkzaamheden.</strong>
  {% else %}
    <p>Opdrachtnemer: {{ location.activity.contractor }}<br />
    Werkzaamheid: {{ location.activity.measurement_type }}</p>
  {% endif %}

  {% with measurements=location.measurement_set.all %}
    {% if measurements %}
      <p>Bestanden:</p>
      <table class="table">
      <thead>
        <th>Bestand</th>
        <th>Type</th>
        <th>Aanwezig</th>
        <th>Verwijderen</th>
      </thead>
        {% for measurement in measurements %}
          {% if measurement.data.filetype == "ribx" %}
            <tr>
              <td><a href="{{ measurement.get_absolute_url }}">{{ measurement.base_filename }}</a>
              </td>
              <td>RIBX</td>
              <td>Ja</td>
              <td>
                {% if not location.activity.project.is_archived %}
                  <a href="{{ measurement.get_absolute_url }}" class="delete_measurement" data-message="Als dit bestand alleen bij deze locatie hoort, wordt het verwijderd van de Uploadservice. Weet u dit zeker?">Annuleren</a>
                {% endif %}
              </td>
            </tr>
            {% with attachments=measurement.attached_measurements %}
              {% for attachment in attachments %}
                <tr>
                  <td><a href="{{ attachment.get_absolute_url }}">{{ attachment.base_filename }}</a></td>
                  <td>Media</td>
                  <td>Ja</td>
                  <td>
                    {% if not location.activity.project.is_archived %}
                      <a href="{{ attachment.get_absolute_url }}" class="delete_measurement" data-message="Als dit bestand alleen bij deze locatie hoort, wordt het verwijderd van de Uploadservice. Weet u dit zeker?">Annuleren</a>
                    {% endif %}
                  </td>
                </tr>
              {% endfor %}
            {% endwith %}
            {% with attachments=measurement.missing_attachments %}
              {% for a in attachments %}
                <tr>
                   <td>{{ a.filename }}</td>
                   <td>Media</td>
                   <td>Nee</td>
                   <td></td>
                </tr>
              {% endfor %}
            {% endwith %}
          {% endif %}
        {% endfor %}
      </table>
    {% endif %}
  {% endwith %}
  {% if location.planned_date %}
    <p>De geplande datum voor deze locatie is {{ location.planned_date|date:"DATE_FORMAT" }}.</p>
  {% endif %}
{% endwith %}

{% if not location.activity.project.is_archived %}
<script>
$("a.delete_measurement").click(function (event) {
    event.preventDefault();
    if (confirm($(this).attr("data-message"))) {
        // Send a DELETE request to the measurement's URL
        $.ajax({
            url: $(this).attr("href"),
            type: 'DELETE',
            success: function () {
                location.reload(true);
            }
        });
    }
});
</script>
{% endif %}
